0|infra-sh | Resource=i}async turnPage(){let e=await this.nextPageUrl;if(!e)return null;this.spec.fullPath=e;let r=await this.stripeResource._makeRequest([],this.spec,{});return this.nextPageUrl=Promise.resolve(r.next_page_url),this.currentPageIterator=Promise.resolve(r.data[Symbol.iterator]()),this.currentPageIterator}async next(){{let n=(await this.currentPageIterator).next();if(!n.done)return{done:!1,value:n.value}}let e=await this.turnPage();if(!e)return{done:!0,value:void 0};let r=e.next();return r.done?{done:!0,value:void 0}:{done:!1,value:r.value}}},lE=(t,e,r,n)=>{let i=Ji(r.fullPath||r.path);return i!=="v2"&&r.methodType==="search"?hv(new gv(n,e,r,t)):i!=="v2"&&r.methodType==="list"?hv(new vv(n,e,r,t)):i==="v2"&&r.methodType==="list"?hv(new yv(n,e,r,t)):null},hv=t=>{let e=GF((...i)=>t.next(...i)),r=HF(e),n={autoPagingEach:e,autoPagingToArray:r,next:()=>t.next(),return:()=>({}),[BF()]:()=>n};return n};function BF(){return typeof Symbol<"u"&&Symbol.asyncIterator?Symbol.asyncIterator:"@@asyncIterator"}function zF(t){if(t.length<2)return null;let e=t[1];if(typeof e!="function")throw Error(`The second argument to autoPagingEach, if present, must be a callback function; received ${typeof e}`);return e}function $F(t){if(t.length===0)return;let e=t[0];if(typeof e!="function")throw Error(`The first argument to autoPagingEach, if present, must be a callback function; received ${typeof e}`);if(e.length===2)return e;if(e.length>2)throw Error(`The \`onItem\` callback function passed to autoPagingEach must accept at most two arguments; got ${e}`);return function(n,i){let s=e(n);i(s)}}function UF(t,e){let r=e?0:t.data.length-1,n=t.data[r],i=n&&n.id;if(!i)throw Error("Unexpected: No `id` found on the last item while auto-paging a list.");return i}function GF(t){return function(){let r=[].slice.call(arguments),n=$F(r),i=zF(r);if(r.length>2)throw Error(`autoPagingEach takes up to two arguments; received ${r}`);let s=QF(t,n);return to(s,i)}}function HF(t){return function(r,n){let i=r&&r.limit;if(!i)throw Error("You must pass a `limit` option to autoPagingToArray, e.g., `autoPagingToArray({limit: 1000});`.");if(i>1e4)throw Error("You cannot specify a limit of more than 10,000 items to fetch in `autoPagingToArray`; use `autoPagingEach` to iterate through longer lists.");let s=new Promise((a,o)=>{let u=[];t(c=>{if(u.push(c),u.length>=i)return!1}).then(()=>{a(u)}).catch(o)});return to(s,n)}}function QF(t,e){return new Promise((r,n)=>{function i(s){if(s.done){r();return}let a=s.value;return new Promise(o=>{e(a,o)}).then(o=>o===!1?i({done:!0,value:void 0}):t().then(i))}t().then(i).catch(n)})}function pE(t){let e=[].slice.call(t);return!!Zi(e).ending_before}function dE(t){if(t.path!==void 0&&t.fullPath!==void 0)throw new Error(`Method spec specified both a 'path' (${t.path}) and a 'fullPath' (${t.fullPath}).`);return function(...e){let r=typeof e[e.length-1]=="function"&&e.pop();t.urlParams=YP(t.fullPath||this.createResourcePathWithSymbols(t.path||""));let n=to(this._makeRequest(e,t,{}),r);return Object.assign(n,lE(this,e,t,n)),n}}f.extend=eE;f.method=dE;f.MAX_BUFFERED_REQUEST_METRICS=100;function f(t,e){if(this._stripe=t,e)throw new Error("Support for curried url params was dropped in stripe-node v7.0.0. Instead, pass two ids.");this.basePath=Ju(this.basePath||t.getApiField("basePath")),this.resourcePath=this.path,this.path=Ju(this.path),this.initialize(...arguments)}f.prototype={_stripe:null,path:"",resourcePath:"",basePath:null,initialize(){},requestDataProcessor:null,validateRequest:null,createFullPath(t,e){let r=[this.basePath(e),this.path(e)];if(typeof t=="function"){let n=t(e);n&&r.push(n)}else r.push(t);return this._joinUrlParts(r)},createResourcePathWithSymbols(t){return t?`/${this._joinUrlParts([this.resourcePath,t])}`:`/${this.resourcePath}`},_joinUrlParts(t){return t.join("/").replace(/\/{2,}/g,"/")},_getRequestOpts(t,e,r){var n;let i=(e.method||"GET").toUpperCase(),s=e.usage||[],a=e.urlParams||[],o=e.encode||(k=>k),u=!!e.fullPath,c=Ju(u?e.fullPath:e.path||""),l=u?e.fullPath:this.createResourcePathWithSymbols(e.path),p=[].slice.call(t),d=a.reduce((k,N)=>{let Q=p.shift();if(typeof Q!="string")throw new Error(`Stripe: Argument "${N}" must be a string, but got: ${Q} (on API request to \`${i} ${l}\`)`);return k[N]=Q,k},{}),m=Zi(p),h=o(Object.assign({},m,r)),v=Xu(p),y=v.host||e.host,w=!!e.streaming||!!v.streaming;if(p.filter(k=>k!=null).length)throw new Error(`Stripe: Unknown arguments (${p}). Did you mean to pass an options object? See https://github.com/stripe/stripe-node/wiki/Passing-Options. (on API request to ${i} \`${l}\`)`);let T=u?c(d):this.createFullPath(c,d),_=Object.assign(v.headers,e.headers);e.validator&&e.validator(h,{headers:_});let P=e.method==="GET"||e.method==="DELETE";return{requestMethod:i,requestPath:T,bodyData:P?null:h,queryData:P?h:{},authenticator:(n=v.authenticator)!==null&&n!==void 0?n:null,headers:_,host:y??null,streaming:w,settings:v.settings,usage:s}},_makeRequest(t,e,r){return new Promise((n,i)=>{var s;let a;try{a=this._getRequestOpts(t,e,r)}catch(d){i(d);return}function o(d,m){d?i(d):n(e.transformResponseData?e.transformResponseData(m):m)}let u=Object.keys(a.queryData).length===0,c=[a.requestPath,u?"":"?",Ur(a.queryData,Ji(a.requestPath))].join(""),{headers:l,settings:p}=a;this._stripe._requestSender._request(a.requestMethod,a.host,c,a.bodyData,a.authenticator,{headers:l,settings:p,streaming:a.streaming},a.usage,o,(s=this.requestDataProcessor)===null||s===void 0?void 0:s.bind(this))})}};var oo=class t{constructor(e=[]){this._segments=[...e]}get segments(){return[...this._segments]}push(e){if(!e)throw new Error("Segment cannot be null or undefined");return new t([...this._segments,e])}pop(){if(this._segments.length===0)throw new Error("Cannot pop from an empty context");return new t(this._segments.slice(0,-1))}toString(){return this._segments.join("/")}static parse(e){return e?new t(e.split("/")):new t([])}};function fE(t){let e={DEFAULT_TOLERANCE:300,signature:null,constructEvent(l,p,d,m,h,v){try{if(!this.signature)throw new Error("ERR: missing signature helper, unable to verify");this.signature.verifyHeader(l,p,d,m||e.DEFAULT_TOLERANCE,h,v)}catch(w){throw w instanceof Wi&&(w.message+="\nUse `await constructEventAsync(...)` instead of `constructEvent(...)`"),w}return l instanceof Uint8Array?JSON.parse(new TextDecoder("utf8").decode(l)):JSON.parse(l)},async constructEventAsync(l,p,d,m,h,v){if(!this.signature)throw new Error("ERR: missing signature helper, unable to verify");return await this.signature.verifyHeaderAsync(l,p,d,m||e.DEFAULT_TOLERANCE,h,v),l instanceof Uint8Array?JSON.parse(new TextDecoder("utf8").decode(l)):JSON.parse(l)},generateTestHeaderString:function(l){let p=c(l),d=p.signature||p.cryptoProvider.computeHMACSignature(p.payloadString,p.secret);return p.generateHeaderString(d)},generateTestHeaderStringAsync:async function(l){let p=c(l),d=p.signature||await p.cryptoProvider.computeHMACSignatureAsync(p.payloadString,p.secret);return p.generateHeaderString(d)}},r={EXPECTED_SCHEME:"v1",verifyHeader(l,p,d,m,h,v){let{decodedHeader:y,decodedPayload:w,details:T,suspectPayloadType:_}=i(l,p,this.EXPECTED_SCHEME),P=/\s/.test(d);h=h||u();let M=h.computeHMACSignature(n(w,T),d);return s(w,y,T,M,m,_,P,v),!0},async verifyHeaderAsync(l,p,d,m,h,v){let{decodedHeader:y,decodedPayload:w,details:T,suspectPayloadType:_}=i(l,p,this.EXPECTED_SCHEME),P=/\s/.test(d);h=h||u();let M=await h.computeHMACSignatureAsync(n(w,T),d);return s(w,y,T,M,m,_,P,v)}};function n(l,p){return`${p.timestamp}.${l}`}function i(l,p,d){if(!l)throw new Ht(p,l,{message:"No webhook payload was provided."});let m=typeof l!="string"&&!(l instanceof Uint8Array),h=new TextDecoder("utf8"),v=l instanceof Uint8Array?h.decode(l):l;if(Array.isArray(p))throw new Error("Unexpected: An array was passed as a header, which should not be possible for the stripe-signature header.");if(p==null||p=="")throw new Ht(p,l,{message:"No stripe-signature header value was provided."});let y=p instanceof Uint8Array?h.decode(p):p,w=a(y,d);if(!w||w.timestamp===-1)throw new Ht(y,v,{message:"Unable to extract timestamp and signatures from header"});if(!w.signatures.length)throw new Ht(y,v,{message:"No signatures found with expected scheme"});return{decodedPayload:v,decodedHeader:y,details:w,suspectPayloadType:m}}function s(l,p,d,m,h,v,y,w){let T=!!d.signatures.filter(t.secureCompare.bind(t,m)).length,_=`
0|infra-sh |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
0|infra-sh |
0|infra-sh | Error: DATABASE_URL must be set. Did you forget to provision a database?
0|infra-sh |     at Object.<anonymous> (/var/www/Infra-Shield-Tools/dist/index.cjs:76:103627)
0|infra-sh |     at Module._compile (node:internal/modules/cjs/loader:1521:14)
0|infra-sh |     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
0|infra-sh |     at Module.load (node:internal/modules/cjs/loader:1266:32)
0|infra-sh |     at Module._load (node:internal/modules/cjs/loader:1091:12)
0|infra-sh |     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
0|infra-sh |     at node:internal/main/run_main_module:28:49
0|infra-sh |
0|infra-sh | Node.js v20.20.0
