0|infra-sh | ath:e.path||""),l=u?e.fullPath:this.createResourcePathWithSymbols(e.path),p=[].slice.call(t),d=a.reduce((k,N)=>{let Q=p.shift();if(typeof Q!="string")throw new Error(`Stripe: Argument "${N}" must be a string, but got: ${Q} (on API request to \`${i} ${l}\`)`);return k[N]=Q,k},{}),m=Zi(p),h=o(Object.assign({},m,r)),v=Xu(p),y=v.host||e.host,w=!!e.streaming||!!v.streaming;if(p.filter(k=>k!=null).length)throw new Error(`Stripe: Unknown arguments (${p}). Did you mean to pass an options object? See https://github.com/stripe/stripe-node/wiki/Passing-Options. (on API request to ${i} \`${l}\`)`);let T=u?c(d):this.createFullPath(c,d),_=Object.assign(v.headers,e.headers);e.validator&&e.validator(h,{headers:_});let P=e.method==="GET"||e.method==="DELETE";return{requestMethod:i,requestPath:T,bodyData:P?null:h,queryData:P?h:{},authenticator:(n=v.authenticator)!==null&&n!==void 0?n:null,headers:_,host:y??null,streaming:w,settings:v.settings,usage:s}},_makeRequest(t,e,r){return new Promise((n,i)=>{var s;let a;try{a=this._getRequestOpts(t,e,r)}catch(d){i(d);return}function o(d,m){d?i(d):n(e.transformResponseData?e.transformResponseData(m):m)}let u=Object.keys(a.queryData).length===0,c=[a.requestPath,u?"":"?",Ur(a.queryData,Ji(a.requestPath))].join(""),{headers:l,settings:p}=a;this._stripe._requestSender._request(a.requestMethod,a.host,c,a.bodyData,a.authenticator,{headers:l,settings:p,streaming:a.streaming},a.usage,o,(s=this.requestDataProcessor)===null||s===void 0?void 0:s.bind(this))})}};var oo=class t{constructor(e=[]){this._segments=[...e]}get segments(){return[...this._segments]}push(e){if(!e)throw new Error("Segment cannot be null or undefined");return new t([...this._segments,e])}pop(){if(this._segments.length===0)throw new Error("Cannot pop from an empty context");return new t(this._segments.slice(0,-1))}toString(){return this._segments.join("/")}static parse(e){return e?new t(e.split("/")):new t([])}};function fE(t){let e={DEFAULT_TOLERANCE:300,signature:null,constructEvent(l,p,d,m,h,v){try{if(!this.signature)throw new Error("ERR: missing signature helper, unable to verify");this.signature.verifyHeader(l,p,d,m||e.DEFAULT_TOLERANCE,h,v)}catch(w){throw w instanceof Wi&&(w.message+="\nUse `await constructEventAsync(...)` instead of `constructEvent(...)`"),w}return l instanceof Uint8Array?JSON.parse(new TextDecoder("utf8").decode(l)):JSON.parse(l)},async constructEventAsync(l,p,d,m,h,v){if(!this.signature)throw new Error("ERR: missing signature helper, unable to verify");return await this.signature.verifyHeaderAsync(l,p,d,m||e.DEFAULT_TOLERANCE,h,v),l instanceof Uint8Array?JSON.parse(new TextDecoder("utf8").decode(l)):JSON.parse(l)},generateTestHeaderString:function(l){let p=c(l),d=p.signature||p.cryptoProvider.computeHMACSignature(p.payloadString,p.secret);return p.generateHeaderString(d)},generateTestHeaderStringAsync:async function(l){let p=c(l),d=p.signature||await p.cryptoProvider.computeHMACSignatureAsync(p.payloadString,p.secret);return p.generateHeaderString(d)}},r={EXPECTED_SCHEME:"v1",verifyHeader(l,p,d,m,h,v){let{decodedHeader:y,decodedPayload:w,details:T,suspectPayloadType:_}=i(l,p,this.EXPECTED_SCHEME),P=/\s/.test(d);h=h||u();let M=h.computeHMACSignature(n(w,T),d);return s(w,y,T,M,m,_,P,v),!0},async verifyHeaderAsync(l,p,d,m,h,v){let{decodedHeader:y,decodedPayload:w,details:T,suspectPayloadType:_}=i(l,p,this.EXPECTED_SCHEME),P=/\s/.test(d);h=h||u();let M=await h.computeHMACSignatureAsync(n(w,T),d);return s(w,y,T,M,m,_,P,v)}};function n(l,p){return`${p.timestamp}.${l}`}function i(l,p,d){if(!l)throw new Ht(p,l,{message:"No webhook payload was provided."});let m=typeof l!="string"&&!(l instanceof Uint8Array),h=new TextDecoder("utf8"),v=l instanceof Uint8Array?h.decode(l):l;if(Array.isArray(p))throw new Error("Unexpected: An array was passed as a header, which should not be possible for the stripe-signature header.");if(p==null||p=="")throw new Ht(p,l,{message:"No stripe-signature header value was provided."});let y=p instanceof Uint8Array?h.decode(p):p,w=a(y,d);if(!w||w.timestamp===-1)throw new Ht(y,v,{message:"Unable to extract timestamp and signatures from header"});if(!w.signatures.length)throw new Ht(y,v,{message:"No signatures found with expected scheme"});return{decodedPayload:v,decodedHeader:y,details:w,suspectPayloadType:m}}function s(l,p,d,m,h,v,y,w){let T=!!d.signatures.filter(t.secureCompare.bind(t,m)).length,_=`
0|infra-sh |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
0|infra-sh |
0|infra-sh | Error: DATABASE_URL must be set. Did you forget to provision a database?
0|infra-sh |     at Object.<anonymous> (/var/www/Infra-Shield-Tools/dist/index.cjs:76:103627)
0|infra-sh |     at Module._compile (node:internal/modules/cjs/loader:1521:14)
0|infra-sh |     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
0|infra-sh |     at Module.load (node:internal/modules/cjs/loader:1266:32)
0|infra-sh |     at Module._load (node:internal/modules/cjs/loader:1091:12)
0|infra-sh |     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
0|infra-sh |     at node:internal/main/run_main_module:28:49
0|infra-sh |
0|infra-sh | Node.js v20.20.0
